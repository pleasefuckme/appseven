webpackJsonp([2,33],{24:function(t,e,a){t.exports=a.p+"static/img/loanBanner3.ad43349.jpg"},166:function(t,e,a){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(2),s=o(n);e.default={name:"PostForm",data:function(){return{title:"工单系统",content:"工单提交",floss:[],osffloorname:"",fbrss:[],ossroom:"",eqnss:[],fbname:"",depss:[],osddepartment:"",peoss:[],fullname:"",contact:"",text:"",file:""}},mounted:function(){this.getDep(),this.getFlo()},methods:{getFile:function(t){console.log("file////*****="+this.$refs.file)},submitForm:function(t){var e=this,a=/^1[3456789]\d{9}$/;if(console.log(this.contact),a.test(this.contact)){var o=new Date;t.preventDefault();var n=new FormData;n.append("region",this.osffloorname),n.append("rooms",this.ossroom),n.append("eqname",this.fbname),n.append("department",this.osddepartment),n.append("reporter",this.fullname),n.append("contact",this.contact),n.append("text",this.text),n.append("photo",this.file),n.append("state",1),n.append("create_date",o),n.append("urgent",1),console.log("当000"+this.file);var r={headers:{"Content-Type":"multipart/form-data"}};s.default.post("/api/ospworkorder/opsworkorder/interface/appsave",n,r).then(function(t){console.log(t),console.log(r),console.log(e.ossroom+"===++++===***111****="+e.fbname),e.$dialog(["提交成功","true"])}).catch(function(t){console.log(t)})}else this.$dialog("输入有效的号码")},getFlo:function(){var t=this,e={};this.$axios.post("api/opsspacespaceinfor/opsspacespaceinfor/interface/eqfloor?buildingid=",e).then(function(e){0!=e.data?(t.floss=e.data,console.log(t.floss)):console.log(1)}).catch(function(t){that.$message.ERROR("系统错误！")})},getFbr:function(){var t=this;console.log("floorid"+this.fbfloor);var e={};this.$axios.post("api/opsspacespaceinfor/opsspacespaceinfor/interface/eqroom?buildingid=&floorid="+this.osffloorname,e).then(function(e){0!=e.data?(t.fbrss=e.data,console.log(t.fbrss)):console.log(1)}).catch(function(t){that.$message.ERROR("系统错误！")})},getEqn:function(){var t=this,e={};this.$axios.post("api/ospworkorder/opsworkorder/interface/eqdevice?floorid="+this.osffloorname+"&roomid="+this.ossroom,e).then(function(e){0!=e.data?(t.eqnss=e.data,console.log(t.eqnss),console.log("eqid"+t.fbname)):console.log(1)}).catch(function(t){that.$message.ERROR("系统错误！")})},getDep:function(){var t=this;console.log(this.id);var e={};this.$axios.post("api/ospworkorder/opsworkorder/interface/departapp?department=",e).then(function(e){0!=e.data?(t.depss=e.data,console.log(t.depss)):console.log(1)}).catch(function(t){that.$message.ERROR("系统错误！")})},getPeo:function(){var t=this,e={};this.$axios.post("api/ospworkorder/opsworkorder/interface/peoapp?id="+this.osddepartment,e).then(function(e){0!=e.data?(t.peoss=e.data,console.log(t.peoss)):console.log(1)}).catch(function(t){that.$message.ERROR("系统错误！")})},uploadserpRecords:function(t){var e=t.target.files[0].target.console.log("文件="+t);console.log("文件2="+t.target.files[0]),console.log("文件3="+t.target.files),console.log("文件4="+e),void 0!==e&&(e.size/1024>1025?that.photoCompress(e,{quality:.2},function(t){var e=that.base64UrlToBlob(t);that.uploadLice(e)}):this.uploadLice(e))},base64UrlToBlob:function(t){for(var e=t.split(","),a=e[0].match(/:(.*?);/)[1],o=atob(e[1]),n=o.length,s=new Uint8Array(n);n--;)s[n]=o.charCodeAt(n);var r=Date.parse(new Date)+".jpg";return new File([s],r,{type:a})},photoCompress:function(t,e,a){var o=this,n=new FileReader;n.readAsDataURL(t),n.onload=function(){var t=this.result;o.canvasDataURL(t,e,a)}},canvasDataURL:function(t,e,a){var o=new Image;o.src=t,o.onload=function(){var t=this,o=t.width,n=t.height,s=o/n;o=e.width||o,n=e.height||o/s;var r=.2,i=document.createElement("canvas"),l=i.getContext("2d"),p=document.createAttribute("width");p.nodeValue=o;var c=document.createAttribute("height");c.nodeValue=n,i.setAttributeNode(p),i.setAttributeNode(c),l.drawImage(t,0,0,o,n),e.quality&&e.quality>=1&&e.quality<0&&(r=e.quality);var u=i.toDataURL("image/jpeg",r);a(u)}},uploadLice:function(t){var e=this;console.log("file357行="+t),uploadLog(t,function(t){e.form.operatingLicense=t,console.log("360行="+t)})}}}},262:function(t,e,a){e=t.exports=a(10)(),e.push([t.id,"input::-webkit-input-placeholder,textarea::-webkit-input-placeholder{color:#aab2bd;font-size:12px}",""])},298:function(t,e,a){var o=a(262);"string"==typeof o&&(o=[[t.id,o,""]]);a(11)(o,{});o.locals&&(t.exports=o.locals)},347:function(t,e,a){a(298);var o=a(1)(a(166),a(407),null,null);t.exports=o.exports},407:function(t,e,a){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"container no-top"},[o("loanBanner",{attrs:{tit:t.title,des:t.content}},[o("img",{attrs:{slot:"banner",src:a(24)},slot:"banner"})]),t._v(" "),o("div",{staticClass:"loanDetail"},[o("form",[o("dl",[o("dd",[o("p",{staticStyle:{margin:"0px 0px 0px"}},[o("label",{attrs:{for:"osffloorname"}},[t._v("所在区域\n\t                "),o("select",{directives:[{name:"model",rawName:"v-model",value:t.osffloorname,expression:"osffloorname"}],staticClass:"fr",staticStyle:{"font-size":"0.75rem",margin:"3px 10px 0px","text-align":"right","text-align-last":"right"},attrs:{value:"",required:"required"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.osffloorname=e.target.multiple?a:a[0]}}},[o("option",{staticClass:"fr",attrs:{disabled:"",value:""}},[t._v("请选择区域")]),t._v(" "),t._l(t.floss,function(e,a,n){return o("option",{domProps:{value:e.id}},[t._v("\n\t                \t\t"+t._s(n)+t._s(e.osffloorname)+"\n\t                \t")])})],2)])]),t._v(" "),o("p",{staticStyle:{margin:"10px 0px 0px"}},[o("label",{attrs:{for:"ossroom"}},[t._v("所在单体\n\t                "),o("select",{directives:[{name:"model",rawName:"v-model",value:t.ossroom,expression:"ossroom"}],staticClass:"fr",staticStyle:{"font-size":"0.75rem",margin:"3px 10px 0px","text-align":"right","text-align-last":"right"},attrs:{value:"",required:"required"},on:{click:t.getFbr,change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.ossroom=e.target.multiple?a:a[0]}}},[o("option",{staticClass:"fr",attrs:{disabled:"",value:""}},[t._v("请选择单体")]),t._v(" "),t._l(t.fbrss,function(e,a,n){return o("option",{domProps:{value:e.id}},[t._v("\n\t                \t\t"+t._s(n)+t._s(e.ossroom)+"\n\t                \t")])})],2)])]),t._v(" "),o("p",{staticStyle:{margin:"9px 0px 0px"}},[o("label",{attrs:{for:"fbname"}},[t._v("设备名称\n\t                "),o("select",{directives:[{name:"model",rawName:"v-model",value:t.fbname,expression:"fbname"}],staticClass:"fr",staticStyle:{"font-size":"0.75rem",margin:"3px 10px 0px","text-align":"right","text-align-last":"right"},attrs:{value:"",required:"required"},on:{click:t.getEqn,change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.fbname=e.target.multiple?a:a[0]}}},[o("option",{staticClass:"fr",attrs:{disabled:"",value:""}},[t._v("请选择设备")]),t._v(" "),t._l(t.eqnss,function(e,a,n){return o("option",{domProps:{value:e.id}},[t._v("\n\t                \t\t"+t._s(n)+t._s(e.fbname)+"\n\t                \t")])})],2)])]),t._v(" "),o("p",{staticStyle:{margin:"10px 0px 0px"}},[o("label",{attrs:{for:"osddepartment"}},[t._v("报修部门\n\t                "),o("select",{directives:[{name:"model",rawName:"v-model",value:t.osddepartment,expression:"osddepartment"}],staticClass:"fr",staticStyle:{"font-size":"0.75rem",margin:"3px 10px 0px","text-align":"right","text-align-last":"right"},attrs:{value:"",required:"required"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.osddepartment=e.target.multiple?a:a[0]}}},[o("option",{staticClass:"fr",attrs:{disabled:"",value:""}},[t._v("请选择部门")]),t._v(" "),t._l(t.depss,function(e,a,n){return o("option",{domProps:{value:e.id}},[t._v("\n\t                \t\t"+t._s(n)+t._s(e.osddepartment)+"\n\t                \t")])})],2)])]),t._v(" "),o("p",{staticStyle:{margin:"10px 0px 0px"}},[o("label",{attrs:{for:"fullname"}},[t._v("报修人\n\t                  "),o("select",{directives:[{name:"model",rawName:"v-model",value:t.fullname,expression:"fullname"}],staticClass:"fr",staticStyle:{"font-size":"0.75rem",margin:"3px 10px 0px","text-align":"right","text-align-last":"right"},attrs:{required:"required",value:""},on:{click:t.getPeo,change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.fullname=e.target.multiple?a:a[0]}}},[o("option",{staticClass:"fr",attrs:{disabled:"",value:""}},[t._v("请选择报修人")]),t._v(" "),t._l(t.peoss,function(e,a,n){return o("option",{domProps:{value:e.id}},[t._v("\n\t                \t\t"+t._s(n)+t._s(e.fullname)+"\n\t                \t")])})],2)])]),t._v(" "),o("p",{staticStyle:{margin:"10px 0px 0px"}},[t._v("联系方式\n        "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.contact,expression:"contact"}],staticClass:"fr",staticStyle:{"text-align":"right","font-size":"16px",margin:"-1px 10px 0px"},attrs:{type:"text",required:"required",maxlength:"11",value:"",placeholder:"请输入11位移动电话"},domProps:{value:t.contact},on:{input:function(e){e.target.composing||(t.contact=e.target.value)}}})]),t._v(" "),o("p",{staticStyle:{margin:"10px 0px 0px"}},[t._v("报修内容\n        "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],staticClass:"fr",staticStyle:{"text-align":"right","font-size":"16px",margin:"2px 10px 0px"},attrs:{type:"text",required:"required",maxlength:"70",value:"",placeholder:"请输入报修内容"},domProps:{value:t.text},on:{input:function(e){e.target.composing||(t.text=e.target.value)}}})]),t._v(" "),o("p",{staticStyle:{margin:"10px 0px 0px"}},[t._v("拍照上传\n\t\t\t"),o("input",{staticClass:"fr",staticStyle:{"text-align":"right","font-size":"2px",margin:"0px 0px 0px 0px",float:"none"},attrs:{type:"file",accept:"",multiple:"multiple",value:""},on:{click:t.uploadserpRecords}})])])]),t._v(" "),o("button",{staticClass:"subBtn",staticStyle:{width:"90%",padding:"0",margin:"10px 17px 20px",float:"left","box-sizing":"border-box"},attrs:{type:"primary"},on:{click:function(e){t.submitForm(e),t.$router.push("/credit/submit")}}},[t._v("提交工单")])])]),t._v(" "),o("footComponent",{attrs:{idx:1}})],1)},staticRenderFns:[]}}});